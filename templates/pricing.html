{% extends "base.html" %}

{% block title %}Tarification - Cagnotte{% endblock %}

{% block content %}
<div class="container-fluid py-5">
    <div class="row justify-content-center">
        <div class="col-12 col-lg-8">
            <!-- Header -->
            <div class="text-center mb-5">
                <h1 class="display-4 fw-bold mb-3" style="color: var(--primary-color);">
                    <i class="fas fa-tags me-3"></i>Tarifs Simples et Transparents
                </h1>
                <p class="lead mb-4" style="color: var(--text-secondary);">
                    Commencez gratuitement, évoluez selon vos besoins
                </p>
            </div>

            <!-- Plans -->
            <div class="row justify-content-center">
                <!-- Plan Gratuit -->
                <div class="col-12 col-md-6 col-lg-5 mb-4">
                    <div class="card h-100 border shadow pricing-card position-relative">
                        <!-- Header du plan -->
                        <div class="card-header text-center py-4" style="background-color: var(--primary-color); color: white;">
                            <div class="plan-icon mb-3">
                                <i class="fas fa-seedling fa-3x" style="color: white;"></i>
                            </div>
                            <h3 class="card-title h4 mb-2">Gratuit</h3>
                            <div class="price-display">
                                <span class="price-amount">0</span>
                                <span class="price-currency">DT</span>
                                <span class="price-period">/mois</span>
                            </div>
                        </div>

                        <!-- Corps du plan -->
                        <div class="card-body p-4">
                            <p class="text-center mb-4" style="color: var(--text-secondary);">
                                Parfait pour découvrir Cagnotte et gérer vos finances personnelles
                            </p>

                            <!-- Fonctionnalités -->
                            <ul class="list-unstyled features-list mb-4">
                                <li class="feature-item">
                                    <i class="fas fa-check" style="color: var(--success-color); margin-right: 0.5rem;"></i>
                                    <span>Jusqu'à <strong>3 groupes</strong></span>
                                </li>
                                <li class="feature-item">
                                    <i class="fas fa-check" style="color: var(--success-color); margin-right: 0.5rem;"></i>
                                    <span><strong>100 dépenses</strong> par mois</span>
                                </li>
                                <li class="feature-item">
                                    <i class="fas fa-check" style="color: var(--success-color); margin-right: 0.5rem;"></i>
                                    <span>Rapports <strong>basiques</strong></span>
                                </li>
                                <li class="feature-item">
                                    <i class="fas fa-check" style="color: var(--success-color); margin-right: 0.5rem;"></i>
                                    <span>Support <strong>communautaire</strong></span>
                                </li>
                                <li class="feature-item">
                                    <i class="fas fa-check" style="color: var(--success-color); margin-right: 0.5rem;"></i>
                                    <span>Gestion des revenus et dépenses</span>
                                </li>
                                <li class="feature-item">
                                    <i class="fas fa-check" style="color: var(--success-color); margin-right: 0.5rem;"></i>
                                    <span>Catégorisation automatique</span>
                                </li>
                            </ul>

                            <!-- Bouton CTA -->
                            <div class="text-center">
                                {% if current_user.is_authenticated %}
                                    <button class="btn btn-primary btn-lg w-100 py-3 fw-bold" disabled>
                                        <i class="fas fa-check-circle me-2"></i>Plan actuel
                                    </button>
                                {% else %}
                                    <a href="{{ url_for('register') }}" class="btn btn-primary btn-lg w-100 py-3 fw-bold">
                                        <i class="fas fa-rocket me-2"></i>Commencer gratuitement
                                    </a>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Plan Premium -->
                <div class="col-12 col-md-6 col-lg-5 mb-4">
                    <div class="card h-100 border shadow pricing-card premium-card position-relative">
                        <!-- Badge Premium -->
                        <div class="premium-badge">
                            <i class="fas fa-crown"></i>
                            <span class="ms-1">Premium</span>
                        </div>

                        <!-- Header du plan -->
                        <div class="card-header text-center py-4" style="background-color: #1e293b; color: white;">
                            <div class="plan-icon mb-3">
                                <i class="fas fa-crown fa-3x" style="color: #fbbf24;"></i>
                            </div>
                            <h3 class="card-title h4 mb-2">Premium</h3>
                            <div class="price-display">
                                <span class="price-amount">9.99</span>
                                <span class="price-currency">DT</span>
                                <span class="price-period">/mois</span>
                            </div>
                        </div>

                        <!-- Corps du plan -->
                        <div class="card-body p-4">
                            <p class="text-center mb-4" style="color: var(--text-secondary);">
                                Pour les utilisateurs qui veulent toutes les fonctionnalités avancées
                            </p>

                            <!-- Fonctionnalités -->
                            <ul class="list-unstyled features-list mb-4">
                                <li class="feature-item">
                                    <i class="fas fa-star" style="color: #fbbf24; margin-right: 0.5rem;"></i>
                                    <span><strong>Groupes illimités</strong></span>
                                </li>
                                <li class="feature-item">
                                    <i class="fas fa-star" style="color: #fbbf24; margin-right: 0.5rem;"></i>
                                    <span><strong>Dépenses illimitées</strong></span>
                                </li>
                                <li class="feature-item">
                                    <i class="fas fa-star" style="color: #fbbf24; margin-right: 0.5rem;"></i>
                                    <span>Rapports <strong>avancés</strong></span>
                                </li>
                                <li class="feature-item">
                                    <i class="fas fa-star" style="color: #fbbf24; margin-right: 0.5rem;"></i>
                                    <span>Application <strong>mobile</strong></span>
                                </li>
                                <li class="feature-item">
                                    <i class="fas fa-star" style="color: #fbbf24; margin-right: 0.5rem;"></i>
                                    <span>Support <strong>prioritaire</strong></span>
                                </li>
                                <li class="feature-item">
                                    <i class="fas fa-star" style="color: #fbbf24; margin-right: 0.5rem;"></i>
                                    <span>Budgets intelligents</span>
                                </li>
                                <li class="feature-item">
                                    <i class="fas fa-star" style="color: #fbbf24; margin-right: 0.5rem;"></i>
                                    <span>Analyses prédictives</span>
                                </li>
                                <li class="feature-item">
                                    <i class="fas fa-star" style="color: #fbbf24; margin-right: 0.5rem;"></i>
                                    <span>Sauvegarde automatique</span>
                                </li>
                            </ul>

                            <!-- Bouton CTA -->
                            <div class="text-center">
                                {% if current_user.is_authenticated %}
                                    <button class="btn btn-warning btn-lg w-100 py-3 fw-bold" onclick="startFreeTrial()">
                                        <i class="fas fa-gift me-2"></i>Essai gratuit 30 jours
                                    </button>
                                {% else %}
                                    <button class="btn btn-warning btn-lg w-100 py-3 fw-bold" onclick="startFreeTrial()">
                                        <i class="fas fa-gift me-2"></i>Essai gratuit 30 jours
                                    </button>
                                {% endif %}
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Call to Action Simple -->
            <div class="row mt-5">
                <div class="col-12">
                    <div class="text-center">
                        <p class="mb-4" style="color: var(--text-secondary); font-size: 1.1rem;">
                            Prêt à prendre le contrôle de vos finances ?
                        </p>
                        {% if not current_user.is_authenticated %}
                            <a href="{{ url_for('register') }}" class="btn btn-primary btn-lg px-5 py-3 fw-bold">
                                <i class="fas fa-user-plus me-2"></i>Commencer gratuitement
                            </a>
                        {% endif %}
                    </div>
                </div>
            </div>
        </div>
    </div>
</div>
{% endblock %}

{% block scripts %}
<script>
// Animation simple des cartes au scroll
document.addEventListener('DOMContentLoaded', function() {
    const pricingCards = document.querySelectorAll('.pricing-card');

    const observer = new IntersectionObserver((entries) => {
        entries.forEach((entry, index) => {
            if (entry.isIntersecting) {
                setTimeout(() => {
                    entry.target.style.opacity = '1';
                    entry.target.style.transform = 'translateY(0)';
                }, index * 150);
            }
        });
    }, {
        threshold: 0.1
    });

    pricingCards.forEach(card => {
        card.style.opacity = '0';
        card.style.transform = 'translateY(20px)';
        card.style.transition = 'opacity 0.5s ease, transform 0.5s ease';
        observer.observe(card);
    });
});

// Fonction pour démarrer l'essai gratuit de 30 jours
function startFreeTrial() {
    {% if current_user.is_authenticated %}
        // Si l'utilisateur est connecté, rediriger vers la page de mise à niveau
        window.location.href = '{{ url_for("upgrade_to_premium") }}';
    {% else %}
        // Si l'utilisateur n'est pas connecté, rediriger vers l'inscription avec un paramètre d'essai
        window.location.href = '{{ url_for("register") }}?trial=premium';
    {% endif %}
}
</script>

<style>
/* Styles personnalisés pour la page de tarification sobre */
.pricing-card {
    transition: all 0.3s ease;
    border-radius: 12px;
    overflow: hidden;
}

.pricing-card:hover {
    transform: translateY(-5px);
    box-shadow: var(--shadow-lg);
}

.price-display {
    display: flex;
    align-items: baseline;
    justify-content: center;
    margin-bottom: 10px;
}

.price-amount {
    font-size: 3rem;
    font-weight: 700;
    color: white;
}

.price-currency {
    font-size: 1.5rem;
    margin-left: 5px;
    opacity: 0.9;
}

.price-period {
    font-size: 1.2rem;
    margin-left: 5px;
    opacity: 0.8;
}

.plan-icon {
    opacity: 0.9;
}

.features-list {
    padding: 0;
}

.feature-item {
    padding: 8px 0;
    border-bottom: 1px solid var(--border-color);
    display: flex;
    align-items: center;
}

.feature-item:last-child {
    border-bottom: none;
}

.feature-item strong {
    color: var(--primary-color);
}

.premium-badge {
    position: absolute;
    top: 15px;
    right: -25px;
    background-color: #fbbf24;
    color: #1e293b;
    padding: 6px 25px 6px 15px;
    border-radius: 15px 0 0 15px;
    font-size: 0.8rem;
    font-weight: 600;
    transform: rotate(0deg);
    z-index: 10;
    box-shadow: 0 2px 8px rgba(251, 191, 36, 0.3);
}

.premium-card {
    border: 2px solid #fbbf24;
    position: relative;
}

.premium-card::before {
    content: '';
    position: absolute;
    top: 0;
    left: 0;
    right: 0;
    height: 4px;
    background-color: #fbbf24;
}

@media (max-width: 768px) {
    .pricing-card {
        margin-bottom: 30px;
    }

    .price-amount {
        font-size: 2.5rem;
    }

    .premium-badge {
        right: -15px;
        padding: 4px 20px 4px 10px;
        font-size: 0.7rem;
    }
}
</style>
{% endblock %}